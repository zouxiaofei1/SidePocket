<Window x:Class="SidePocket.PocketButtonWindow"
        x:Name="ThisWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        Topmost="True" ShowInTaskbar="False"
        Width="32" Height="32" ResizeMode="NoResize">
    <Border Name="MainBorder" CornerRadius="16" Background="{DynamicResource CardBackgroundBrush}" BorderBrush="{DynamicResource BorderBrush}" 
            BorderThickness="1.5" Cursor="Hand" MouseLeftButtonDown="Border_MouseLeftButtonDown"
            RenderTransformOrigin="0.5,0.5">
        <Border.RenderTransform>
            <TransformGroup>
                <ScaleTransform x:Name="MainScale" ScaleX="1" ScaleY="1"/>
                <RotateTransform x:Name="MainRotate" Angle="0"/>
            </TransformGroup>
        </Border.RenderTransform>
        <Border.Effect>
            <DropShadowEffect x:Name="MainShadow" BlurRadius="12" ShadowDepth="0" Color="#0078D4" Opacity="0.3"/>
        </Border.Effect>
        <Grid>
            <!-- 第二层逆向流光背景 -->
            <Ellipse x:Name="StreamGlowBack" Margin="-3">
                <Ellipse.Fill>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#7B5EFF" Offset="0.0"/>
                        <GradientStop Color="Transparent" Offset="0.5"/>
                        <GradientStop Color="#7B5EFF" Offset="1.0"/>
                    </LinearGradientBrush>
                </Ellipse.Fill>
                <Ellipse.RenderTransform>
                    <RotateTransform x:Name="StreamRotateBack" Angle="0" CenterX="19" CenterY="19"/>
                </Ellipse.RenderTransform>
                <Ellipse.OpacityMask>
                    <RadialGradientBrush>
                        <GradientStop Color="Black" Offset="0.5"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.OpacityMask>
            </Ellipse>

            <!-- 流光背景 -->
            <Ellipse x:Name="StreamGlow" Margin="-2">
                <Ellipse.Fill>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#0078D4" Offset="0.0"/>
                        <GradientStop Color="#00B7F0" Offset="0.5"/>
                        <GradientStop Color="#0078D4" Offset="1.0"/>
                    </LinearGradientBrush>
                </Ellipse.Fill>
                <Ellipse.RenderTransform>
                    <RotateTransform x:Name="StreamRotate" Angle="0" CenterX="17" CenterY="17"/>
                </Ellipse.RenderTransform>
                <Ellipse.OpacityMask>
                    <RadialGradientBrush>
                        <GradientStop Color="Black" Offset="0.8"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.OpacityMask>
            </Ellipse>

            <!-- 内部毛玻璃感 -->
            <Ellipse Margin="1" Fill="{DynamicResource FluentGlassBrush}" Opacity="0.8"/>

            <!-- 精致的收纳图标 SVG (类似口袋或文件夹) -->
            <Path x:Name="IconPath" Data="M19,20H5V4H7V7H17V4H19V10H21V4A2,2 0 0,0 19,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V18H19V20M17,13V7H7V13H17M15,9H9V11H15V9M21,14H12V16H21V14Z" 
                  Fill="{DynamicResource PrimaryGradientBrush}" Stretch="Uniform" Margin="8" RenderTransformOrigin="0.5,0.5">
                <Path.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform x:Name="IconScale" ScaleX="1" ScaleY="1"/>
                        <RotateTransform x:Name="IconRotate" Angle="0"/>
                    </TransformGroup>
                </Path.RenderTransform>
            </Path>
        </Grid>
    </Border>

    <Window.Resources>
        <Storyboard x:Key="ExitStoryboard">
            <DoubleAnimation Storyboard.TargetName="ThisWindow" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="MainScale" Storyboard.TargetProperty="ScaleX" To="0" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <BackEase Amplitude="1" EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="MainScale" Storyboard.TargetProperty="ScaleY" To="0" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <BackEase Amplitude="1" EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </Window.Resources>

    <Window.Triggers>
        <EventTrigger RoutedEvent="Window.Loaded">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.3"/>
                    <DoubleAnimation Storyboard.TargetName="MainScale" Storyboard.TargetProperty="ScaleX" From="0" To="1" Duration="0:0:0.6">
                        <DoubleAnimation.EasingFunction>
                            <ElasticEase Oscillations="1" Springiness="4" EasingMode="EaseOut"/>
                        </DoubleAnimation.EasingFunction>
                    </DoubleAnimation>
                    <DoubleAnimation Storyboard.TargetName="MainScale" Storyboard.TargetProperty="ScaleY" From="0" To="1" Duration="0:0:0.6">
                        <DoubleAnimation.EasingFunction>
                            <ElasticEase Oscillations="1" Springiness="4" EasingMode="EaseOut"/>
                        </DoubleAnimation.EasingFunction>
                    </DoubleAnimation>
                    <DoubleAnimation Storyboard.TargetName="IconRotate" Storyboard.TargetProperty="Angle" From="-180" To="0" Duration="0:0:0.8">
                        <DoubleAnimation.EasingFunction>
                            <BackEase Amplitude="1" EasingMode="EaseOut"/>
                        </DoubleAnimation.EasingFunction>
                    </DoubleAnimation>

                    <!-- 旋转光效动画 -->
                    <DoubleAnimation Storyboard.TargetName="StreamRotate" Storyboard.TargetProperty="Angle" From="0" To="360" Duration="0:0:4" RepeatBehavior="Forever"/>
                    <DoubleAnimation Storyboard.TargetName="StreamRotateBack" Storyboard.TargetProperty="Angle" From="360" To="0" Duration="0:0:3" RepeatBehavior="Forever"/>

                    <!-- 持续呼吸发光效果 -->
                    <DoubleAnimation Storyboard.TargetName="MainShadow" Storyboard.TargetProperty="BlurRadius" From="12" To="20" Duration="0:0:2" AutoReverse="True" RepeatBehavior="Forever"/>
                    <DoubleAnimation Storyboard.TargetName="MainShadow" Storyboard.TargetProperty="Opacity" From="0.3" To="0.6" Duration="0:0:2" AutoReverse="True" RepeatBehavior="Forever"/>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
        <EventTrigger RoutedEvent="MouseEnter" SourceName="MainBorder">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetName="MainScale" Storyboard.TargetProperty="ScaleX" To="1.2" Duration="0:0:0.2"/>
                    <DoubleAnimation Storyboard.TargetName="MainScale" Storyboard.TargetProperty="ScaleY" To="1.2" Duration="0:0:0.2"/>
                    <DoubleAnimation Storyboard.TargetName="IconScale" Storyboard.TargetProperty="ScaleX" To="1.1" Duration="0:0:0.2"/>
                    <DoubleAnimation Storyboard.TargetName="IconScale" Storyboard.TargetProperty="ScaleY" To="1.1" Duration="0:0:0.2"/>
                    <DoubleAnimation Storyboard.TargetName="MainShadow" Storyboard.TargetProperty="BlurRadius" To="20" Duration="0:0:0.2"/>
                    <DoubleAnimation Storyboard.TargetName="MainShadow" Storyboard.TargetProperty="Opacity" To="0.5" Duration="0:0:0.2"/>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
        <EventTrigger RoutedEvent="MouseLeave" SourceName="MainBorder">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetName="MainScale" Storyboard.TargetProperty="ScaleX" To="1.0" Duration="0:0:0.2"/>
                    <DoubleAnimation Storyboard.TargetName="MainScale" Storyboard.TargetProperty="ScaleY" To="1.0" Duration="0:0:0.2"/>
                    <DoubleAnimation Storyboard.TargetName="IconScale" Storyboard.TargetProperty="ScaleX" To="1.0" Duration="0:0:0.2"/>
                    <DoubleAnimation Storyboard.TargetName="IconScale" Storyboard.TargetProperty="ScaleY" To="1.0" Duration="0:0:0.2"/>
                    <DoubleAnimation Storyboard.TargetName="MainShadow" Storyboard.TargetProperty="BlurRadius" To="12" Duration="0:0:0.2"/>
                    <DoubleAnimation Storyboard.TargetName="MainShadow" Storyboard.TargetProperty="Opacity" To="0.3" Duration="0:0:0.2"/>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Window.Triggers>
</Window>
